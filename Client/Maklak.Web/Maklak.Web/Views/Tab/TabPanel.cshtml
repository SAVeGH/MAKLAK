@model Maklak.Models.TabPanelModel

@*style="width:150px;height:150px;background-color:antiquewhite;float:left"*@

@{ 
    string panelClass = string.Empty;
    string stripClass = string.Empty;
    string contentClass = string.Empty;
    string classPrefix = string.Empty;


    string tabPanelKey = this.Model.TabPanelKey;
    string nextTabPanelKey = this.Model.NextTabPanelKey;
    string tabPanelID = string.Format("TabPanel_{0}", tabPanelKey);
    //string childTabPanelID = string.Format("TabPanel_{0}", childPanelKey);

    switch (this.Model.DokPosition)
    {
        case Maklak.Models.TabPanelModel.DOKPOSITION.LEFT:
            classPrefix = "left";
            break;
        case Maklak.Models.TabPanelModel.DOKPOSITION.TOP:
            classPrefix = "top";
            break;
        case Maklak.Models.TabPanelModel.DOKPOSITION.RIGHT:
            classPrefix = "right";
            break;
        case Maklak.Models.TabPanelModel.DOKPOSITION.BOTTOM:
            classPrefix = "bottom";
            break;
    }

    panelClass = string.Format("{0}TabPanel", classPrefix);
    stripClass = string.Format("{0}StripArea", classPrefix);
    contentClass = string.Format("{0}ContentArea", classPrefix);

    bool hasChildPanel = this.Model.HasChildPanel;
    RouteValueDictionary routPanelValues = new RouteValueDictionary();
    routPanelValues.Add("Key", nextTabPanelKey); /*меняется ключ и следующая TabPanel модель привязывается к дочернему ключу*/
    RouteValueDictionary routStripValues = new RouteValueDictionary();
    routStripValues.Add("Key", tabPanelKey); /* название модели для TabStrip совпадает с ключом текущей модели*/
    routStripValues.Add("TabPanelID", tabPanelID);

 }

<div id="@tabPanelID" class="@panelClass">

    <div class="@stripClass">
        @*Strip*@
        @Html.Action("TabStrip", "Tab", routStripValues)
    </div>
    <div class="@contentClass">
        @*Content*@
        @{
            if (hasChildPanel)
            {
                Html.RenderAction("TabPanel", "Tab", routPanelValues);
            }

         }        
    </div>
</div>

